---
title: Unicode Normalization Bypass
description: 
published: true
date: 2025-07-25T16:41:08.398Z
tags: 
editor: markdown
dateCreated: 2025-07-23T11:13:10.888Z
---

# Unicode Normalization Bypass

## 개요
“Unicode Normalization Bypass”는 웹 애플리케이션 사용자 입력을 저장하거나 처리하기 전에 적용하는 Unicode 정규화(normalization) 과정에서, 특정 Unicode 문자를 ASCII 동등 문자(예: Kelvin 기호 K → ‘K')로 변환하는 불일치를 악용하는 취약점이다. 공격자는 K 같은 특수문자를 삽입한 스크립트나 SQL 페이로드를 입력에 포함시키면, WAF나 애플리케이션 초기 필터에서는 탐지되지 않다가, 내부에서는 ASCII 'K’로 변경되어 공격 코드가 완성되도록 유도 가능하다. 이 방식은 Unicode 정규화 방식(NFC, NFD, NFKC 등)의 차이와 파서 간 미세한 처리 방식 차이를 활용하며, 그 결과 WAF・애플리케이션 필터를 우회하여 XSS, SQL Injection, CSRF 등의 공격 벡터를 숨길 수 있다.

## 분류

> 데이터 표현 모델 불일치 (Data Representation Gap)  
> → 유사문자 및 정규화 처리 문제 (Homoglyph & Normalization Issues)  
> → Unicode Normalization Bypass

## 절차

| Phase           | Description                                                                                                                                                                               |
|-----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Reconnaissance  | `%C3%A9(U+00E9) vs e%CC%81(U+0065+U+0301)` 같은 이중 표현을 요청해, 응답·로그·검색 결과에서 정규화 방식과 실행 시점을 파악한다.                                               |
| Obfuscation     | 공격에 필요한 문자(',<,>)는 먼저 각 문자에 대응하는 호환 유니코드 코드포인트로 치환해서 필터를 속이고 추가 우회를 위해 해당 코드 포인트를 한 번 더 인코딩한다.               |
| Injection       | 취약 파라미터에 `?name_search=chloe%EF%BC%87 UNION SELECT username,password FROM users--` 과 같은 난독화된 페이로드를 삽입한다.                                                  |
| Bypass          | 애플리케이션은 필터 단계에서 ASCII ', <, > 등만 탐지하지만 그 다음 단계에서 `String.Normalize()` 등을 호출하여 정규화한다. 이 때, 공격자가 넣은 유니코드 변형 문자가 원본 ASCII로 재조합되어 최종 쿼리, HTML에 삽입되고 필터가 무력화된다. |
| Validation      | 반사된 응답이나 DB 레코드에서 ASCII 문자로 변환된 것을 직접 확인한다.                                                                                                             |
| Exploitation    | 정규화 취약점을 이용해 SQL 인젝션(UNION‑based, Boolean‑based) 또는 XSS 페이로드를 삽입·실행한다.                                                                                  |
| Exfiltration    | SQL 결과에 섞인 민감 데이터 반환, 또는 XSS를 통한 쿠키·세션 탈취로 실제 정보를 유출한다.                                                                                             |

<div style="text-align: left;">
  <img
    src="/unicode_normalization_bypass.png"
    alt="Unicode Normalization Bypass 다이어그램"
    width="1000"
    style="display: block;
           margin: 0 0 1em 0;
           height: auto;"
  />
</div>

## 공격 기법

### Reconnaissance

| 공격 이름                    | 예시               | 설명                                                                                                                                     | 출처 |
|------------------------------|--------------------|------------------------------------------------------------------------------------------------------------------------------------------|------|
| Normalization Fingerprinting | `?param=%E2%84%AA` | 모든 정규화 방식에서 ASCII 'K'로 변환되는 켈빈 기호(K)를 전송한다. 응답에서 'K'가 반환되는지 확인해, 백엔드 시스템의 정규화 존재 여부와 시점을 파악한다. | [1]  |

### Obfuscation

| 공격 이름                    | 예시                       | 설명                                                                                                                              | 출처 |
|------------------------------|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------|------|
| Homoglyph-based Substitution | `' → %EF%BC%87 (U+FF07)`   | SQL 인젝션에 필요한 작은따옴표(')를 필터링이 탐지하지 못하도록, 시각적으로는 유사하지만 코드 포인트가 다른 전각 문자(Full-width)로 치환하여 페이로드를 난독화한다. | [1]  |

### Injection

| 공격 이름                    | 예시                                 | 설명                                                                                                                                          | 출처 |
|------------------------------|--------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|------|
| Obfuscated Payload Injection | `?name_search=chloe%EF%BC%87UNION...` | 정규화 차이를 악용하도록 난독화된 페이로드를 애플리케이션의 입력 파라미터(name_search)에 주입하여, 공격 코드가 서버 내부에서 처리되도록 전달한다. | [1]  |

### Bypass

| 공격 이름                                 | 예시                                            | 설명                                                                                                                                                                                       | 출처 |
|-------------------------------------------|-------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------|
| Filter Evasion via Delayed Normalization  | `string.Normalize(NormalizationForm.FormKD)`    | 애플리케이션이 입력값에서 따옴표를 먼저 제거(`string.Replace`)한 뒤 나중에 유니코드 정규화(`string.Normalize`)를 수행하는 로직을 악용한다. 필터링 단계에서는 안전한 문자로 통과하고, 정규화 과정에서 악성 ASCII 문자로 재조합되어 필터가 무력화된다. | [1]  |

### Validation

| 공격 이름                 | 예시       | 설명                                                                                                                              | 출처 |
|---------------------------|------------|-----------------------------------------------------------------------------------------------------------------------------------|------|
| Reflected Output Analysis | `K → K`    | 공격자가 전송한 특수 유니코드 문자(예: 켈빈 기호 `K`)가 서버 응답에서 정규화된 ASCII 문자(예: `K`)로 변환되어 반환되는지 직접 확인함으로써, 공격의 성공 가능성을 검증한다. | [1]  |

### Exploitation

| 공격 이름                        | 예시                                     | 설명                                                                                                                                      | 출처 |
|----------------------------------|------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|------|
| SQL Injection (UNION-based)      | `UNION SELECT username, password FROM users--` | 정규화 과정에서 되살아난 작은따옴표로 인해 완성된 SQL 구문이 실행되어, users 테이블의 사용자 이름과 비밀번호를 탈취하는 등 데이터베이스에 직접적인 공격을 수행한다.                                             | [1]  |
| Cross-Site Scripting (XSS)       | `?msg=%EF%B9%A4img...%EF%BC%9E`           | 필터를 우회한 유니코드 꺾쇠 문자들이 정규화를 통해 표준 `<`와 `>`로 변환된다. 이를 통해 악성 `<img>` 태그나 스크립트가 피해자의 브라우저에서 실행되도록 만든다.                          | [1]  |

### Exfiltration

| 공격 이름                    | 예시                                                        | 설명                                                                                                                           | 출처 |
|------------------------------|-------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------|------|
| Data Exfiltration via SQLi   | `<b>Name:</b>chloe<br/><b>Bio:</b><br/>admin,Pa$$w0rd`      | 성공적인 SQL 인젝션 공격의 결과로, 데이터베이스에 저장된 민감한 사용자 정보(계정, 비밀번호 등)를 정상적인 웹 페이지 응답에 포함시켜 외부로 유출한다.                                  | [1]  |

---

## 분류에 해당하는 문서
- [1] [Unicode Normalization Vulnerabilities & the Special K Polyglot](https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/)

